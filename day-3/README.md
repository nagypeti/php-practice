How to handle in Yii:
Cross-Site Request Forgery (CSRF) - its built in with form templates.
Cross-site Scripting (XSS) - Yii helpers, html encode.

Dependency injection.